<pbx-modal
        [modalEx]="modal"
        (onConfirmEx)="modalConfirm()"
></pbx-modal>

<div class="buy_phone_grid">
    <div class="buy_phone_header">
        <div class="buy_phone_header_block">
            <div class="buy_phone_header_block_key">Select country:</div>
            <pbx-editable-select [options]="countries"
                                 [objectKey]="'title'"
                                 (onSelect)="selectCountry($event)"
                                 [selected]="selectedCountry">
            </pbx-editable-select>
            <div class="buy_phone_header_block_key">Search:</div>
            <input type="text" placeholder="Type city prefix" (keyup)="searchInit()"
                   [(ngModel)]="requestDetails.areaCode">
        </div>
        <div class="buy_phone_header_block">
            <div class="buy_phone_header_block_key">Number:</div>
            <input #myNumberOnly type="text" name="search-by-digits" placeholder="Search by digits" (keyup)="searchInit()"
                   [(ngModel)]="requestDetails.contains">
            <div class="buy_phone_header_block_key">Match to:</div>
            <pbx-select [options]="matches" [objectKey]="'title'" [selected]="matches[0]"></pbx-select>
        </div>
        <div class="buy_phone_header_options">
            <div class="buy_phone_header_options_title">Number types:</div>
            <pbx-checkbox [value]="requestDetails.local"
                          (onToggle)="requestDetails.local = $event; getList()"></pbx-checkbox>
            <div>Local</div>
            <pbx-checkbox [value]="requestDetails.mobile"
                          (onToggle)="requestDetails.mobile = $event; getList()"></pbx-checkbox>
            <div>Mobile</div>
            <pbx-checkbox [value]="requestDetails.tollFree"
                          (onToggle)="requestDetails.tollFree = $event; getList()"></pbx-checkbox>
            <div>Toll-free</div>
        </div>
        <div class="buy_phone_header_refresh" (click)="getList()">Refresh phone lists
            <svg-icon class="buy_phone_header_refresh_icon" src="../../assets/icons/refresh.svg"></svg-icon>
        </div>
    </div>
    <pbx-loader *ngIf="loading"></pbx-loader>
    <div class="buy_phone_table_contain" *ngIf="!loading && list[0].length > 0">
        <div class="buy_phone_table_title">
            <div class="buy_phone_table_item" *ngFor="let item of title">{{item}}</div>
        </div>
        <div class="buy_phone_table_title">
            <div class="buy_phone_table_item" *ngFor="let item of title">{{item}}</div>
        </div>
    </div>
    <div class="buy_phone_table_contain scroll" *ngIf="!loading">
        <div class="buy_phone_table_body" *ngFor="let table of list">
            <div class="buy_phone_table_row" *ngFor="let item of table">
                <div class="buy_phone_table_item">+{{item.fullNumber}}</div>
                <div class="buy_phone_table_item">{{item.areaName||'Unknown'}}</div>
                <div class="buy_phone_table_item">{{item.sum?'$'+item.sum:'Free'}}</div>
                <div class="buy_phone_table_item">
                    <pbx-button value="Buy" buttonType="success" [loading]="item.loading" (onClick)="buyItem(item)"
                                [inactive]="item.inactive"></pbx-button>
                </div>
            </div>
        </div>
    </div>
    <div class="table-message" *ngIf="!loading && list[0].length === 0">
        <span *ngIf="!requestDetails.contains">No data to display</span>
        <span *ngIf="requestDetails.contains">Sorry, no matches were found for "{{requestDetails.contains}}"</span>
    </div>
    <div class="buy_phone_pagination" *ngIf="pagination.total>1">
        <pbx-pagination [currentPage]="pagination.page"
                        [totalPages]="pagination.total"
                        (onPageChange)="onPageChange($event)"
        ></pbx-pagination>
    </div>
</div>
