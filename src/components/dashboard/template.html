<div class="dashboard_wrap">
    <pbx-loader class="inactive dashboard_balance" *ngIf="loading"></pbx-loader>
    <div class="dashboard_item dashboard_balance" *ngIf="!loading">
        <div class="dashboard_item_title_row">
            <div class="dashboard_item_title_key">Balance</div>
            <div class="dashboard_balance_value">{{dashboard.balance.currency.shortName}}{{dashboard.balance.value}}
            </div>
        </div>
        <div class="dashboard_item_title_row">
            <div class="dashboard_item_title_key">ETT</div>
            <div class="dashboard_balance_value">{{dashboard.balance.ett}}</div>
        </div>
        <div class="dashboard_item_link_row">
            <a class="dashboard_item_link_item" [routerLink]="'../dashboard'" routerLinkActive="active">
                Transaction history
                <svg-icon class="dashboard_item_icon" src="../../assets/icons/_middle/dropdown_arrow_12px.svg"></svg-icon>
            </a>
            <a class="dashboard_item_link_item dashboard_center" [routerLink]="'../dashboard'"
               routerLinkActive="active">
                Invoices
                <svg-icon class="dashboard_item_icon" src="../../assets/icons/_middle/dropdown_arrow_12px.svg"></svg-icon>
            </a>
            <a class="dashboard_item_link_item" routerLink="/cabinet/refill" routerLinkActive="active">
                Refill
                <svg-icon class="dashboard_item_icon" src="../../assets/icons/_middle/dropdown_arrow_12px.svg"></svg-icon>
            </a>
        </div>
    </div>
    <pbx-loader class="inactive dashboard_tariff" *ngIf="loading"></pbx-loader>
    <div class="dashboard_item dashboard_tariff" *ngIf="!loading">
        <div class="dashboard_item_title_row">
            <div class="dashboard_item_title_key">Tariff plan</div>
            <div class="dashboard_item_title_value">{{dashboard.tariffPlan.title}}</div>
        </div>
        <div class="dashboard_item_content_row">
            <div class="dashboard_item_content_key">Next monthly payment</div>
            <div class="dashboard_item_content_value">
                {{dashboard.balance.currency.shortName}}{{dashboard.tariffPlan.sum}}
            </div>
        </div>
        <div class="dashboard_item_content_row">
            <div class="dashboard_item_content_key">Payment date</div>
            <div class="dashboard_item_content_value">{{dashboard.tariffPlan.displayExpired}}</div>
        </div>
        <div class="dashboard_item_link_row">
            <a [routerLink]="'../tariff'" routerLinkActive="active" class="dashboard_item_link_item">
                Change tariff plan
                <svg-icon class="dashboard_item_icon" src="../../assets/icons/_middle/dropdown_arrow_12px.svg"></svg-icon>
            </a>
        </div>
    </div>
    <pbx-loader class="inactive dashboard_numbers" *ngIf="loading"></pbx-loader>
    <div class="dashboard_item dashboard_numbers" *ngIf="!loading">
        <div class="dashboard_item_title_row">
            <div class="dashboard_item_title_name">Phone numbers</div>
        </div>
        <div class="dashboard_numbers_body">
            <div class="dashboard_item_content_row" *ngFor="let number of dashboard.numbers">
                <div class="dashboard_item_content_key">{{number.phoneNumber}}</div>
                <div class="dashboard_item_content_value">{{number.innerOnlineCount}} of {{number.innerCount}} online
                </div>
            </div>
        </div>
        <div class="dashboard_item_link_row">
            <a class="dashboard_item_link_item dashboard_right" [routerLink]="'../dashboard'" routerLinkActive="active">
                Details
                <svg-icon class="dashboard_item_icon" src="../../assets/icons/_middle/dropdown_arrow_12px.svg"></svg-icon>
            </a>
        </div>
    </div>
    <pbx-loader class="inactive dashboard_drive" *ngIf="loading"></pbx-loader>
    <div class="dashboard_item dashboard_drive" *ngIf="!loading">
        <div class="dashboard_drive_row">
            <div class="dashboard_drive_content">
                <div class="dashboard_item_title_row">
                    <div class="dashboard_item_title_name">Drive</div>
                </div>
                <div class="dashboard_item_content_row">
                    <div class="dashboard_item_content_key">Total size</div>
                    <div class="dashboard_item_content_value">{{dashboard.storage.totalSize}}
                        {{dashboard.storage.measure}}
                    </div>
                </div>
                <div class="dashboard_item_content_row">
                    <div class="dashboard_item_content_key">Available space</div>
                    <div class="dashboard_item_content_value">{{dashboard.storage.availableSize}}
                        {{dashboard.storage.measure}}
                    </div>
                </div>
                <div class="dashboard_item_content_row">
                    <div class="dashboard_item_content_key">Used space</div>
                    <div class="dashboard_item_content_value">{{dashboard.storage.usedSize}}
                        {{dashboard.storage.measure}}
                    </div>
                </div>
            </div>
            <div class="dashboard_drive_diagram">
                <div class="dashboard_drive_percentage">
                    {{((dashboard.storage.usedSize)/(dashboard.storage.totalSize))*100 | number: '1.0-0'}}%
                </div>
                <style>

                </style>
                <!-- i try to create diagram -->

                <pbx-circle-progress
                        [value]="((dashboard.storage.usedSize)/(dashboard.storage.totalSize))*100 | number: '1.0-0'"></pbx-circle-progress>

                <!--<svg width="120" height="120" viewBox="0 0 120 120" class="progress__svg">-->
                <!--<circle [attr.r]="radius" cx="60" cy="60" stroke-width="12" class="progress__meter" />-->
                <!--<circle [style.strokeDasharray]="circumference" [style.strokeDashoffset]="dashoffset" [attr.r]="radius" cx="60" cy="60" stroke-width="12" class="progress__value" />-->
                <!--</svg>-->
                <!--<svg class="dashboard_drive_circle dashboard_hide_low_resolution">-->
                <!--<circle cx="88" cy="88" r="76" stroke-width="24" fill="none"></circle>-->
                <!--<path class="circle-diagram" stroke-width="24" fill="none" stroke-dasharray="120, 477"-->
                <!--d="M 12, 88 a 76,76 0 1,0 152,0 a 76,76 0 1,0 -152,0">-->
                <!--</path>-->
                <!--</svg>-->
                <!--<svg class="dashboard_drive_circle dashboard_hide_high_resolution">-->
                <!--<circle cx="48" cy="48" r="40" stroke-width="16" fill="none"></circle>-->
                <!--<path stroke-width="16" fill="none"-->
                <!--d="M 8,48 A 40,40 0 0,1 65.0311716626029,11.8069179013592">-->
                <!--</path>-->
                <!--</svg>-->
            </div>
        </div>
        <div class="dashboard_item_link_row">
            <a [routerLink]="'../dashboard'" routerLinkActive="active" class="dashboard_item_link_item">
                Details
                <svg-icon class="dashboard_item_icon" src="../../assets/icons/_middle/dropdown_arrow_12px.svg"></svg-icon>
            </a>
        </div>
    </div>
    <pbx-loader class="inactive dashboard_history" *ngIf="loading"></pbx-loader>
    <div class="dashboard_history" *ngIf="!loading">
        <div class="dashboard_item_title_row">
            <div class="dashboard_item_title_name">History</div>
        </div>
        <div class="dashboard_history_body" *ngIf="dashboard.callDetail.length > 0">
            <div class="dashboard_history_wrap" *ngFor="let historyBlock of dashboard.callDetail">
                <div class="dashboard_history_date">{{historyBlock.analyzeDate}}</div>
                <div class="dashboard_history_item" *ngFor="let historyItem of historyBlock.list"
                     [ngClass]="{'missed': !historyItem.status}">
                    <pbx-loader *ngIf="historyItem.loading"></pbx-loader>
                    <div *ngIf="!historyItem.loading" class="dashboard_history_row">
                        <div class="dashboard_history_details">{{historyItem.name || 'Unknown'}}</div>
                        <div class="dashboard_history_details">{{historyItem.direction === 0 ? historyItem.source :
                            historyItem.destination}}
                        </div>
                    </div>
                    <div *ngIf="!historyItem.loading" class="dashboard_history_row">
                        <div class="dashboard_history_details" *ngIf="historyItem.calculateDuration">
                            {{historyItem.calculateDuration}}
                        </div>
                        <div class="dashboard_history_details">{{historyItem.status === 0 ? historyItem.direction :
                            'missed'}}
                        </div>
                        <div class="dashboard_history_details" *ngIf="!historyItem.calculateDuration">
                            {{historyItem.direction === 0 ? 'incoming' : 'outgoing'}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <a class="dashboard_item_link_row" [routerLink]="'/cabinet/details-and-records'" routerLinkActive="active">Details</a>
    </div>
</div>

