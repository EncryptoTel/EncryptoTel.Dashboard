<pbx-loader *ngIf="loading"></pbx-loader>
<div class="company" *ngIf="!loading">
    <pbx-form [background]="false"
              [decline]="{value: 'Cancel', buttonType: 'cancel'}"
              [confirm]="{value: 'Save', buttonType: 'success'}"
              (onDecline)="modal.visible=true"
              (onConfirm)="save()">
        <form [formGroup]="companyForm">
            <pbx-input name="Organization"
                       key="name"
                       [form]="true"
                       [required]="true"
                       [floatError]="true"
                       [errors]="service.errors"
                       [object]="companyForm">
            </pbx-input>
            <ng-container formArrayName="companyAddress">
                <ng-container *ngFor="let address of addressControls.controls;let i = index" [formGroupName]="i">
                    <pbx-input name="Country"
                               key="country"
                               displayKey="title"
                               (onSelect)="selectCountry($event)"
                               [form]="true"
                               [required]="true"
                               [floatError]="true"
                               [options]="countries"
                               [object]="address"
                               [errors]="service.errors"
                               [objectView]="selectedCountry">
                    </pbx-input>
                    <pbx-input name="State/Region"
                               key="regionName"
                               [form]="true"
                               [required]="true"
                               [floatError]="true"
                               [errorKey]="'companyAddress.new_0.regionName'"
                               [errors]="service.errors"
                               [object]="address">
                    </pbx-input>
                    <pbx-input name="City"
                               key="locationName"
                               [form]="true"
                               [required]="true"
                               [floatError]="true"
                               [errorKey]="'companyAddress.new_0.locationName'"
                               [errors]="service.errors"
                               [object]="address">
                    </pbx-input>
                    <pbx-input name="Street"
                               key="street"
                               [form]="true"
                               [required]="true"
                               [floatError]="true"
                               [errorKey]="'companyAddress.new_0.street'"
                               [errors]="service.errors"
                               [object]="address">
                    </pbx-input>
                    <pbx-input name="House #"
                               key="building"
                               [form]="true"
                               [required]="true"
                               [floatError]="true"
                               [errorKey]="'companyAddress.new_0.building'"
                               [errors]="service.errors"
                               [object]="address">
                    </pbx-input>
                    <pbx-input name="Office"
                               key="office"
                               [form]="true"
                               [floatError]="true"
                               [required]="true"
                               [errorKey]="'companyAddress.new_0.office'"
                               [errors]="service.errors"
                               [object]="address">
                    </pbx-input>
                    <pbx-input name="Postal code"
                               key="postalCode"
                               [form]="true"
                               [floatError]="true"
                               [required]="true"
                               [errorKey]="'companyAddress.new_0.postalCode'"
                               [errors]="service.errors"
                               [object]="address">
                    </pbx-input>
                </ng-container>
            </ng-container>
            <pbx-input name="Email"
                       key="email"
                       [form]="true"
                       [floatError]="true"
                       [required]="true"
                       [errors]="service.errors"
                       [object]="companyForm">
            </pbx-input>
            <pbx-input name="Phone"
                       key="phone"
                       [form]="true"
                       [required]="true"
                       [floatError]="true"
                       [errors]="service.errors"
                       [object]="companyForm">
            </pbx-input>
            <pbx-input name="VAT ID"
                       key="vatId"
                       [form]="true"
                       [floatError]="true"
                       [required]="true"
                       [errors]="service.errors"
                       [object]="companyForm">
            </pbx-input>
        </form>
    </pbx-form>
    <pbx-sidebar [sidebarInfo]="sidebarInfo"></pbx-sidebar>
</div>
<pbx-modal
        [modalEx]="modal" (onConfirmEx)="cancel()"
></pbx-modal>
