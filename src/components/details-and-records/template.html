<div class="details-container">
    <div class="details-wrapper">

        <div class="details-header">

            <!-- filter tags -->
            <div class="details-header__wrap">
                <div class="details-header__wrap-filters">
                    <div class="filters">
                        <button
                                *ngFor="let tag of grid.filter.selectedTags"
                                class="{{ tag.title }} details-button"
                                [ngClass]="{'uppercase' : tag.key === 'sms'}"
                                (click)="grid.filter.toggleTag(tag.key)">
                            {{ tag.title }}
                        </button>
                    </div>
                    <div class="filters">
                        <button
                                *ngFor="let tag of grid.filter.unselectedTags"
                                class="inactive-button details-button"
                                [ngClass]="{'uppercase' : tag.key === 'sms'}"
                                (click)="grid.filter.toggleTag(tag.key)">
                            {{ tag.title }}
                        </button>
                    </div>
                </div>
                <div class="details-header__wrap-daterange-wrapper">
                    <div class="details-header__daterange">26/06/2017 - 30/06/2017</div>
                </div>
            </div>

            <!-- grid header -->
            <div class="details-table-row titles">
                <div *ngFor="let column of grid.columns" (click)="sort(column)" class="details-table-cols">
                    {{ column.title }}
                    <svg-icon src="../../assets/icons/sorting_{{ column.iconSuffix }}_16px.svg" class="details-icons"
                              *ngIf="column.sorted"></svg-icon>
                </div>
                <div class="details-table-cols">
                </div>
            </div>

        </div>

        <div class="details-table-wrapper" *ngIf="!loading">
            <div
                    #row
                    class="details-table-row"
                    *ngFor="let detail of pageInfo.items"
                    [ngClass]="{ 'hover': detail.hover }"
                    (mouseenter)="rowHoverStart(pageInfo.items.indexOf(detail))"
                    (mouseleave)="rowHoverEnd()">
                <pbx-loader *ngIf="detail.loading"></pbx-loader>
                <div *ngIf="!detail.loading" class="details-table-cols" [ngClass]="{'payment-col': detail.statusName === 'payment'}">{{
                    detail.source }}
                </div>
                <div *ngIf="!detail.loading" class="details-table-cols">{{ detail.destination }}</div>
                <div *ngIf="!detail.loading" class="details-table-cols">{{ detail.created }}</div>
                <div *ngIf="!detail.loading" class="details-table-cols">{{ detail.duration | tp }}</div>
                <div *ngIf="!detail.loading" class="details-table-cols tags">
                    <!--(click)="startPlayRecord(pageInfo.items.indexOf(detail))"-->
                    <button class="{{detail.tag}} details-button tag-button">
                        {{ detail.statusName }}
                    </button>
                </div>
                <div *ngIf="!detail.loading" class="details-table-cols price" [ngClass]="{'payment-col': detail.statusName === 'payment'}">${{
                    detail.price }}
                </div>
                <div *ngIf="!detail.loading" class="details-table-cols player">
                    <div class="player-wrap">
                        <div class="player-container"
                             *ngIf="detail.playable"
                             [@PlayerAnimation]="detail.playerAnimationState"
                             (@PlayerAnimation.start)="playerAnimationStart()"
                             (@PlayerAnimation.done)="playerAnimationEnd()">
                            <div class="player-arrow" (click)="playerOpenClose(pageInfo.items.indexOf(detail))">
                                <svg-icon src="../../assets/icons/dropdown_arrow_12px.svg" class="player-arrow-icon"
                                          [ngClass]="{ 'collapse': detail.playerContentShow }"></svg-icon>
                            </div>
                            <div class="player-time" *ngIf="detail.playerContentShow" [@Fade]>{{
                                detail.accountFile.duration | tp }}
                            </div>
                            <div class="player-wave" *ngIf="detail.playerContentShow" [@Fade]>
                                <span class="small active"></span>
                                <span class="tall active"></span>
                                <span class="small active"></span>
                                <span class="small active"></span>
                                <span class="tall active"></span>
                                <span class="small"></span>
                                <span class="small"></span>
                                <span class="tall"></span>
                                <span class="small"></span>
                                <span class="small"></span>
                                <span class="tall"></span>
                                <span class="small"></span>
                                <span class="small"></span>
                                <span class="tall"></span>
                                <span class="small"></span>
                                <span class="small"></span>
                                <span class="tall"></span>
                                <span class="small"></span>
                                <span class="small"></span>
                                <span class="tall"></span>
                                <span class="small"></span>
                                <span class="small"></span>
                                <span class="tall"></span>
                                <span class="small"></span>
                            </div>
                            <div class="player-oreo"></div>
                        </div>
                    </div>
                    <div class="player--play-pause" (click)="togglePlayerPlay(detail)"
                         *ngIf="detail.playable && !detail.mediaLoading">
                        <svg-icon src="../../assets/icons/play_24px.svg" class="details-table-cols-button"
                                  *ngIf="!detail.playing"></svg-icon>
                        <svg-icon src="../../assets/icons/pause_24px.svg" class="details-table-cols-button"
                                  *ngIf="detail.playing"></svg-icon>
                    </div>
                    <div class="player--loader" *ngIf="detail.playable && detail.mediaLoading">
                        <img src="../../assets/icons/player_loader.svg" alt="loading">
                    </div>
                </div>
                <div *ngIf="!detail.loading" class="details-table-cols">
                    <div class="details-table-cols-dropdown" (click)="dropOpen($event, pageInfo.items.indexOf(detail))">
                        <span></span>
                        <span></span>
                        <span></span>
                        <ul class="dd-menu" *ngIf="detail.ddShow"
                            [ngClass]="{'top' : this.dropDirection === 'top', 'bottom' : this.dropDirection === 'bottom'}">
                            <li class="dd-menu-button" *ngIf="detail.playable">Download file</li>
                            <li class="dd-menu-button">{{ contactActionName }}</li>
                            <li class="dd-menu-button ban">Block user</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <vg-player (onPlayerReady)="onPlayerReady($event)">
            <vg-controls>
                <vg-play-pause></vg-play-pause>
                <vg-playback-button></vg-playback-button>

                <vg-time-display vgProperty="current" vgFormat="mm:ss"></vg-time-display>

                <vg-scrub-bar>
                    <vg-scrub-bar-current-time></vg-scrub-bar-current-time>
                    <vg-scrub-bar-buffering-time></vg-scrub-bar-buffering-time>
                </vg-scrub-bar>

                <vg-time-display vgProperty="left" vgFormat="mm:ss"></vg-time-display>
                <vg-time-display vgProperty="total" vgFormat="mm:ss"></vg-time-display>

                <vg-mute></vg-mute>
                <vg-volume></vg-volume>
            </vg-controls>

            <audio #media
                   [vgMedia]="media"
                   [vgHls]="currentMediaStream"
                   (onGetBitrates)="hlsBitrates = $event"
                   id="recordAudio"
                   type="audio/mp3">
            </audio>
        </vg-player>

        <pbx-loader *ngIf="loading"></pbx-loader>

        <pbx-pagination [pageInfo]="pageInfo" (onPageChangeEx)="getItems()"></pbx-pagination>

    </div>
</div>
